### 네 개의 영역
- 표현, 응용, 도메인, 인프라스트럭처는 아키텍쳐를 설계할 떄 출현하는 전형적인 네 가지 영역이다.
- 표현 영역은 사용자의 요청을 받아 응용 역역에 전달, 처리 결과를 사용자에게 보여주는 역할을 한다.
- 응욕 역역은 표현 영역을 통해 사용자의 요청을 전달 받는다.
- 응용 역역은 시스템이 사용자에게 제공해야 할 기능을 구현한다.
- 이 때 응용 서비스는 로직을 직접 수행하기보다는 도메인 모델에 로직 수행을 위임한다.
- 도메인 영역은 도메인 모델을 구현한다. 도메인 모델은 도메인의 핵심 로직을 구현한다.
- 인프라스트럭처 역역은 구현 기술에 대한 것은 다룬다. ex) RDBMS 연동, message queue 송수신, Redis나 MonogoDB의 데이터 연동 등
- 인프라스트럭처 영역은 논리적인 개념보다 실제 구현을 다룬다.
- 도메인, 응용, 표현 여역은 구현 기술을 사용한 코드를 직접 만들지 않고 인프라스트럭처 영역에서 제공하는 기능을 사용한다.

### 계층 구조
- 응용 영역과 도메인 영역은 DB나 외부 시스템 연동을 위해 인프라스트럭처 영역에 의존성을 지닐 수 있다.
- 이 떄 두가지 문제가 발생할 수 있는데, '테스트 어려움'과 '기능 확장의 어려움'이다.
- 의존성 역전 원칙(DIP)을 통해 이 문제를 해결할 수 있다.

### DIP
- 고수준 모듈이 제대로 동작하려면 저수준 모듈을 사용해야 한다.
- 고수준 모듈이 저수준 모듈에 의존하면 테스트와 기능 확장이 어려워진다.
- DIP를 활용하면 저수준 모듈이 고수준 모듈에 의존하게 할 수 있다.
- 기존 저수준 모듈을 고수준 모듈의 추상화된 인터페이스를 구현하게 되면, 저수준 모듈은 고수준 모듈에 의존성을 가지고, 고수준 모듈의 저수준 모듈에 대한 의존성은 사라지게 된다.
- 이를 통해 기능 확장의 어려움을 해소할 수 있다. 사용할 저수준 객체만 바꿔주면 된다.
- 테스트 또한 쉬워진다. 저수준 모듈을 직접 구현할 필요 없이 대역 객체를 사용해서 테스트를 쉽게 할 수 있다.
- DIP는 단순히 인터페이스와 구현 클래스를 분리하는 정도가 아니다. 특히 저수준 모듈에서 인페티스를 추출하면 안된다.
- DIP를 항상 적용할 필요는 없다. 사용하는 구현 기술에 따라 완벽한 DIP를 적용하는게 오히려 복잡해지고 개발이 어려워질 수도 있다.

### 도메인 영역의 주요 구성요소
- 도메인 영역의 주요 구성요소는 엔티티, 밸류, 애그리거트, 리포지터리, 도메인 서비스 등이 있다.
- 도메인의 엔티티와 DB 관계형 모델의 엔티티는 같지 않다.
- 도메인 모델의 엔티티는 도메인 기능을 함께 제공한다.
- 엔티티는 단순히 데이터를 담고 있는 데이터 구조가 아니라 데이터와 함께 기능을 제공하는 객체이다.
- 엔티티는 기능을 제공하고 기능 구현을 캡술화한다.
- 또 도메인의 엔티티는 밸류 타입을 사용할 수 있다. RDBMS는 밸류 타입을 제대로 표현하기 힘들다.
- 도메인이 커질수록 많은 엔티티와 밸류가 출현한다. 엔티티와 밸류 개수가 많아질수록 모델은 점점 더 복잡해진다.
- 도메인 모델에서 전체 구조를 이해하는 데 도움이 되는 것이 애그리거트이다.
- 애그리거트는 관련 객체를 하나로 묶은 군집이다. 애그리거트를 통해 객체 군집 단위로 모델을 바라볼 수 있게 된다.
- 애그리거트는 군집에 속한 객체를 관리하는 루트 엔티티를 갖는다.
- 루트 엔티티는 애그리거트의 엔티티와 밸류 객체를 이용해서 애그리거트가 구현해야 할 기능을 제공한다.
- 리포지터리는 도메인 객체의 영속성을 관리한다.

### 모듈 구성
- 모듈 구조를 얼마나 세분화해야 하는지에 대해 정해진 규칙은 없지만, 한 패키지에 너무 많은 타입이 몰려서 불편하지 않으면 된다.
